4月25日报告的提纲。

## 1.tutorial-Book项目简介

## 2.Rust vs. C

## 3.RV特权级架构介绍

M/S/U特权级：处理器所处的不同状态

Trap要素：是否会被屏蔽（屏蔽实际上要考虑到多个特权级）；如果未被屏蔽，被代理到哪个特权级进行处理。

Trap的中断和异常要分开讨论。

特别的，中断是按照特权级区分的，因此可能被屏蔽。

## 4.K210与RustSBI兼容性

### 4.1 时钟中断

无论在K210还是Qemu平台上，时钟中断都是M态的，这意味着无法绕过M态。

在RustSBI/OpenSBI中，在SBI接口的帮助下，完成一轮完整的软件转发cycle。

### 4.2 外部中断

在Qemu平台上，串口中断疑似会被转发为一个S外部中断，因此直接硬件代理即可。

在K210平台上，S外部中断（包括相应处理机制）不存在，硬件和软件转发都不可行。因此只能通过手动跳转。

这种方法还能够用来在完整支持的平台（如Qemu）上，在S态软件中写M态中断的处理代码。

### 4.3 软中断

* 多核启动

### 4.4 异常代理

* 缺页异常
* 非法指令异常

### 4.5 其余不同之处

* RAM
* 访存中的地址对齐
* 相比Qemu，真实存在的icache/dcache/TLB

## 5.功能设计赛道选题简介

## 报告简介

题目：《OS Tutorial实验与K210经验分享》

rCore-Tutorial的目标是向读者展示如何从零开始写OS的一个完整的过程，将课上所学的理论知识应用到项目实践中。项目早期版本的章节设计仿照uCore面向模块化，使得大量硬件特性被过早引入，且整个系统到中后期才能真正意义跑应用。新版Tutorial汲取了编译实验改革的先进经验，每一章都是一个能跑应用的完整内核，随着章节的推进，由于应用需求逐渐复杂化，才会引入相关硬件特性及与之匹配的软件实现，某种程度上这也与OS的历史发展存在相似之处。

报告首先介绍rCore/uCore-Tutorial的设计思想和整体架构。其次讨论实验题目设置，实现难点以及我们实际所收集到的学生反馈。接下来为了能够使参赛者更加深入了解K210开发板并在此基础上更容易上手内核实现，我们从RISC-V特权级架构入手，讲解RustSBI兼容性的实现原理（包括软件/硬件转发和手动跳转），并比较Qemu和K210两个平台的差异。最后，我们分析功能设计赛道预设的赛题并思考项目未来的发展。

## 讲者信息：吴一凡

暂任清华大学计算机系软件所科研助理。rCore-Tutorial第2版、第3.5版的主要作者以及rCore-Tutorial系列项目的维护者，曾将第3版移植到K210平台上并支持SMP。同时也作为RustSBI项目的贡献者，参与外部中断转发、多核启动中的软中断使用、非法指令异常转发等功能的讨论或开发。



 